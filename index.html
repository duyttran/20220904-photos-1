<!doctype html>
<html lang="en">
	<head>
		<!-- https://timnwells.medium.com/enhancing-our-simple-responsive-image-gallery-746549cd2f11 -->
		<!-- https://stackoverflow.com/questions/30912667/how-to-display-list-items-as-columns-preserving-the-left-to-right-order -->
		<meta charset="utf-8">

		<title>Image Gallery</title>
		<meta name="description" content="Responsive Image Gallery">
		<meta name="author" content="Tim Wells">

		<style type="text/css">

		#darkbox { 
			margin:auto;
			left: 5%;
			width:90%; 
			height:90%; 
			position:absolute;
			background-color:#333; overflow: hidden; text-align:center;
		}
		.darkboximg { padding:5%; width: auto; height: 85%; }

		.gallery {
			display: flex;
			flex-flow: column wrap;
		}

		.gallery img {
			width: 50%;
			height: auto;
			outline: 5px solid white;
		}

		.gallery img {
			width: 33%;
		}
		.gallery >:nth-child(2n- 1) {
			order: 1;
		}

		.gallery >:nth-child(3n) {
			order: 2;
		}

		.gallery >:nth-child(-n + 3) {
			break-before: always;
		}
		
		</style>
	</head>
	<body>

		<div class="gallery">
			<img src="photos/D1_001.JPG">
			<img src="photos/D1_002.JPG">
			<img src="photos/D1_003.JPG">
			<img src="photos/D1_004.JPG">
			<img src="photos/D1_005.JPG">
			<img src="photos/D1_006.JPG">
			<img src="photos/D1_007.JPG">
			<img src="photos/D1_008.JPG">
			<img src="photos/D1_009.JPG">
			<img src="photos/D1_010.JPG">
			<img src="photos/D1_011.JPG">
			<img src="photos/D1_012.JPG">
			<img src="photos/D1_013.JPG">
			<img src="photos/D1_014.JPG">
			<img src="photos/D1_015.JPG">
			<img src="photos/D1_016.JPG">
			<img src="photos/D1_017.JPG">
			<img src="photos/D1_018.JPG">
			<img src="photos/D1_019.JPG">
			<img src="photos/D1_020.JPG">
		</div>

		<script>
		let darkBoxVisible = false;

		window.addEventListener('load', (event) => {
			let images = document.querySelectorAll("img");
			if(images !== null && images !== undefined && images.length > 0) {
				images.forEach(function(img) {
					img.addEventListener('click', (evt) => {
						showDarkbox(img.src);
					});
				});
			}
		});

		function zeroPadNum(num) {
			if (num < 10) {
				return '00' + num;
			} else if (num < 100) {
				return '0' + num;
			} else {
				return num;
			}
		}

                function prevImageSrc(src) {
			strNum = src.substring(src.length - 7, src.length - 4);
			prevNum = parseInt(strNum) - 1;
			return src.substring(0, src.length - 7) + zeroPadNum(prevNum) + src.substring(src.length - 4, src.length);
		}

                function nextImageSrc(src) {
			strNum = src.substring(src.length - 7, src.length - 4);
			nextNum = parseInt(strNum) + 1;
			return src.substring(0, src.length - 7) + zeroPadNum(nextNum) + src.substring(src.length - 4, src.length);
		}

		function showDarkbox(url) {
			if(!darkBoxVisible) {
				let y = window.scrollY + 50;

				// Create the darkBox
				var div = document.createElement("div");
				div.id = "darkbox";
				div.innerHTML = '<img class="darkboximg" id="darkboximg" src="'+url+'" />';
				document.body.appendChild(div);
				let box = document.getElementById("darkbox");
				box.style.top = y.toString()+"px";
				box.addEventListener('click', (event) => {
					// Remove it
					let element = document.getElementById("darkbox");
					element.parentNode.removeChild(element);

					darkBoxVisible = false;
				});
				document.addEventListener('keydown', (event) => {
					let element = document.getElementById("darkboximg");
					if (event.key == "ArrowRight") {
						console.log(element.src)
						element.src = nextImageSrc(element.src)
						console.log(element.src)
					} else if (event.key =="ArrowLeft") {
						console.log(element.src)
						element.src = prevImageSrc(element.src)
						console.log(element.src)
					}
				});

				darkBoxVisible = true;

			} else {
				// Remove it
				let element = document.getElementById("darkbox");
				element.parentNode.removeChild(element);

				darkBoxVisible = false;
			}
		}
		</script>

	</body>
</html>
